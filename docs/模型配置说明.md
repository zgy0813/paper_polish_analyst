# AI模型配置说明

## 概述

系统支持按任务类型自动选择最合适的AI模型，以获得最佳的分析效果。

## 模型选择策略

### DeepSeek 模型

系统支持两种DeepSeek模型：

1. **deepseek-chat**
   - 适合：对话、生成、快速任务
   - 用途：批次汇总、全局整合
   - 特点：响应快、成本低

2. **deepseek-reasoner**
   - 适合：复杂推理、深度分析
   - 用途：单篇文档分析
   - 特点：推理能力强、准确性高

## 配置方法

### 自动配置（推荐）

系统会根据任务类型自动选择合适的模型：

```python
# 单篇分析 - 使用 deepseek-reasoner
analyzer = LayeredAnalyzer(task_type='individual')

# 批次汇总 - 使用 deepseek-chat
analyzer = LayeredAnalyzer(task_type='batch')

# 全局整合 - 使用 deepseek-chat
analyzer = LayeredAnalyzer(task_type='global')
```

### 手动配置

通过环境变量自定义：

```bash
# .env 文件
DEEPSEEK_API_KEY=your_api_key
DEEPSEEK_MODEL_INDIVIDUAL=deepseek-reasoner  # 单篇分析
DEEPSEEK_MODEL_BATCH=deepseek-chat          # 批次汇总
DEEPSEEK_MODEL_GLOBAL=deepseek-chat          # 全局整合
```

## 使用场景

### 1. 单篇文档分析

**推荐模型：deepseek-reasoner**

需要深度推理的任务：
- 风格特征分析
- 叙事策略识别
- 论证模式判断
- 修辞手法识别

**优点：**
- 更准确的分析结果
- 更强的逻辑推理能力
- 更好的学术文本理解

### 2. 批次汇总

**推荐模型：deepseek-chat**

需要快速生成汇总的任务：
- 批量处理模式提取
- 规则统计
- 趋势分析

**优点：**
- 更快的响应速度
- 更适合批量处理
- 成本效益更好

### 3. 全局整合

**推荐模型：deepseek-chat**

需要整合分析的任务：
- 全局规则生成
- 风格指南整合
- 最终报告生成

**优点：**
- 高效整合
- 快速输出
- 降低总成本

## 性能对比

| 任务类型 | 推荐模型 | 响应速度 | 准确性 | 成本 |
|---------|---------|---------|--------|------|
| 单篇分析 | deepseek-reasoner | 慢 | 高 | 高 |
| 批次汇总 | deepseek-chat | 快 | 中 | 低 |
| 全局整合 | deepseek-chat | 快 | 中 | 低 |

## 使用示例

```python
from config import Config
from src.analysis.layered_analyzer import LayeredAnalyzer

# 1. 单篇分析
individual_config = Config.get_ai_config(task_type='individual')
analyzer = LayeredAnalyzer(task_type='individual')
result = analyzer.analyze_individual_paper('paper_01', paper_text)

# 2. 批次汇总
batch_config = Config.get_ai_config(task_type='batch')
analyzer = LayeredAnalyzer(task_type='batch')
summary = analyzer.summarize_batch(batch_data)

# 3. 全局整合
global_config = Config.get_ai_config(task_type='global')
analyzer = LayeredAnalyzer(task_type='global')
guide = analyzer.integrate_global_style_union(batch_summaries)
```

## 最佳实践

1. **单篇分析**：始终使用 `deepseek-reasoner`
2. **批量处理**：使用 `deepseek-chat` 以节省成本
3. **灵活切换**：根据任务需求在两者间切换
4. **监控成本**：定期检查API使用情况

## 更新日志

- 2025-10-28: 添加按任务类型选择模型的功能
  - 单篇分析默认使用 deepseek-reasoner
  - 批次和全局使用 deepseek-chat
